** Qt porting for Common Source Code Project **
Aug 07, 2015
K.Ohta

1.About

This package is Qt5 porting of Common Source Code Project (CSP)
and Built with Visual Studio 2015 + DirectX9 + Direct Input 8 for Win32.

 Note: Linux AMD64 and Windows 32bit Binaries are below:
  https://www.sendspace.com/file/d0mxxh
  http://www1.axfc.net/u/3513885

 Filename  : CSP_BUILD_20150807.7z
 MD5SUM    : b25253f389193e74e5502512b36f85f9
 SHA256SUM : 74042657c7b5fc91e86264e42a52ff976ddfea0107fbea2cfba9a71606471abc  

2.Background
Common Source Code Project (CSP) is good emulator writing.
But codes are specified to M$ Visual C.
I'm using GNU/Linux, and I starting to apply FM-7(or later).
So, I start to port to GNU/Linux and using Qt4.

What you need at least:
a. Qt5 (neither Qt3 and Qt4) toolkit.
b. Some OpenGL implementation, maybe at leaset OpenGL v2.x .
c. gcc / g++ (4.7 or later? ) or llvm clang / clang++ (3.5 or later?) toolchain.
d. SDL2 (not SDL1.x).
e. CMake 2.8 or later.

3.How to build:
After extracting (or git pulled) sourcecodes:
$ cd {srctop}/source/build-cmake/{Machine name}/
$ mkdir build
$ cd build

To configure:
$ cmake ..
or
$ ccmake ..

To build:
$ make

To install:
$ sudo make install

4.Qt specified notice:
・Place R@Ms under $HOME/emu{Machine Name}/ , this directory has made
after first using.
・Config file, {foo}.ini is writteon on $HOME/.config/emu{Machine Name}/ .

5.Status
a. I tested to build only under Debian GNU/Linux "sid".
But, perhaps, will succed to build another GNU/Linux OSs or
BSD OS variants.
On windows, using MinGW or Cygwin is not tested yet,
still use M$ Visual Studio 2013 (Community edition).

b. Now, I using Qt5 as toolkit, because authors of Qt announced
"Qt4 is obsolete, will be updated no longer".

c. These machines are already ported to Qt (On Jul 23, 2015):
・Ascii MSX1/MSX2 (not PX-7).
・Casio FP-1100 .
・Casio FP-200 .
・Epson HC-20/40/80.
・Fujitsu FM-7/77/AV .(→ READ readme_fm7.txt)
・Fujitsu FM16pi .
・Fujitsu FM-R50(i286/i386/i486)/R60/R70/R80/R250/R280 (Not tested enough).
・Gijyutu hyouronsya babbage2nd.
・NEC PC-6001/mk2/mk2SR .
・NEC PC-6601/SR .
・NEC PC8001mk2SR (Not tested enough).
・NEC PC8801MA .
・NEC PC-9801/E/U/VF/VM .
・NEC PC98DO .
・NEC PC98LT/HA .
・NEC HE PC-ENGINE.
・NEC TK-80BS .
・NEC HE PC Engine.
・Tomy PYUTA.
・Sega Game Gear/Master System (Mark3).
・Sharp X1/turbo/turboZ/Twin.
・Sharp MZ-700/800/1500 .
・Sharp MZ-80A/K/1200 .
・Sharp MZ-80B/2200/2500 .
・Shinko Sangyou YS-6464a .
・Toshiba J-3100SL .
・Z80 TV Game (Hand made)

c. Now using GCC-5.1 with Link Time Optimize to build for distrubuted binaries.

Upstream repositry:
https://github.com/Artanejp/common_source_project-fm7

Upstream (Takeda Toshiya San's original code)
http://homepage3.nifty.com/takeda-toshiya/

Changes:
 *** If you want to know full changes, please read 000_gitlog.txt . ***

* SNAPSHOT Aug 07, 2015
  * Merged Upstream 2015-08-07.
    To know details : history.txt .
  * DISK : Remove "Hack:Fast transfer" item from menu items. 
  * Built with GIT commit 6a36e02989161ade9242111da520eb28a4dddd66 .
  * Win32/VS2015 : Now don't use "Whole-Program-Optimization".
-- Aug 08, 2015 03:39:15 + 0900 K.Ohta <whatisthis.sowhat@gmail.com>

Upstream changes:
-----
8/7/2015

[VM/DATAREC] support ASCII MSX cas format tape image (thanks Mr.Sean Yong)
[VM/DATAREC] improve mzt converter to support fast forward/rewind
[VM/DISK] improve image decoder for single side and data mark missing cases
[VM/MB8877] fix timing to abort searching the target sector
[VM/MB8877] fix to raise irq signal after abort searching the target sector
[VM/MB8877] fix to abort write command before drq when disk is write protected
[VM/MB8877] fix to abort write command when lost data occurs at first drq
[VM/MB8877] fix to read/write data register when lost data occurs
[VM/MB8877] fix to show crc error when verify track number at seek command
[VM/MB8876] fix not to show busy after seek command for FMR-30/50/60 series


8/5/2015

[WINMAIN] support menu to enable/disable correct fdc timing

[VM/DISK] improve to check both id crc error and data crc error
[VM/I286] fix issue that emulation may go to infinite loop when cpu is halted
[VM/MB8877] fix index hole signal width to 5msec (thanks Mr.Sato)
[VM/MB8877] improve drq signal timing to check E flag of type-2 and 3 commands
[VM/MB8877] improve drq signal timing for write track command
[VM/MB8877] improve data lost timing for write sector and write track commands
[VM/MB8877] improve to check both id crc error and data crc error
[VM/UPD765A] improve timing to go to exec phase
[VM/UPD765A] improve to check both id crc error and data crc error
[VM/Z80SIO] improve transmitting timing (thanks Mr.Sato)

[FMR50/BIOS] improve to check both id crc error and data crc error
[FMR50/BIOS] improve write track command for sectors without data field
[MSX2/MEMORY] improve to check both id crc error and data crc error


8/3/2015

[VM/DISK] support sectors without data field
[VM/MB8877] improve drq signal timing for write sector command (thanks Mr.Sato)
[VM/MB8877] improve index hole signal width (thanks Mr.Sato)
[VM/MB8877] improve read/write command to wait at least 60msec after seeking
[VM/MB8877] improve seek command not to set seek error without verify flag
[VM/MB8877] improve read/write sector commands for sectors without data field
[VM/MB8877] improve write track command for sectors without data field
[VM/MB8877] improve force interrupt command to finish write track command
[VM/MB8877] remove ugly patch for MZ-2500 RELICS
[VM/UPD765A] improve read/write sector commands for sectors without data field
[VM/Z80SIO] improve transmitting timing (thanks Mr.Sato)
-----


Have fun!
-- Ohta.

