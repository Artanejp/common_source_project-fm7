** Qt porting and FM-7/77/AV/AV40/EX for Common Source Code Project **

                                                       August 11, 2017
                            K.Ohta  (whatisthis.sowhat _at_ gmail.com)

1.About

This package is Qt5 porting of Common Source Code Project (CSP)
and built with Qt5, for Windows, built with MinGW(32bit).

Source Code:

   https://github.com/Artanejp/common_source_project-fm7/releases/tag/SNAPSHOT_20170811
   
Additional INFO:

   Binaries will be available, distibute from osdn.net.
   
   See, https://osdn.net/projects/csp-qt/  and
        https://osdn.net/projects/csp-qt/releases/ .
	
   Released at:


2.Background

Common Source Code Project (CSP) is good emulator writing.
It also distributed with GPLv2, this is good for me.

But codes are specified to M$ Visual C.
I'm using GNU/Linux, and I starting to apply FM-7(or later).

So, I start to port to GNU/Linux and using Qt4/Qt5.

What you need at least:

a. Qt5 (neither Qt3 and Qt4) toolkit: Qt5.3 or later.

b. Some OpenGL implementation, maybe at leaset OpenGL v2.x .

c. gcc / g++ (5.0 or later? ) or llvm clang / clang++ (3.5 or later?) toolchain.

d. SDL2 (not SDL1.x).

e. CMake 2.8 or later.

* TIPS: If emufoo.exe don't show screen drawing, set environment variable QT_OPENGL to software (i.e. Using Windows as VirtualBox's gueat OS).


3.How to build:

After extracting (or git pulled) sourcecodes:

$ cd {srctop}/source/build-cmake/{Machine name}/

$ mkdir build

$ cd build

To configure:

$ cmake ..

or

$ ccmake ..

To build:

$ make

To install:

$ sudo make install

4.Qt specified notice:

*Place R@Ms under $HOME/emu{Machine Name}/ , this directory has made
after first using.

*Config file, {foo}.ini is writteon on $HOME/.config/emu{Machine Name}/ .

5.Status

a. I tested to build only under Debian GNU/Linux "sid",Ubuntu Linux 16.04LTS "Xenial" for AMD64 (x86_64)
and MinGW with GCC6 (Windows 32bit).

   But, perhaps, will succed to build another GNU/Linux OSs or BSD OS variants.
   
   * On windows, using MinGW is already okay, but not tested drawing.
   
   * Cross building with GNU/Linux's MinGW32 and Qt5.5.1 (for MinGW) is available. 
     Modify and use build-cmake/config_build_cross_win32.sh and related *.cmake files.
     
   * And, you can also build with M$ Visual Studio 2013 or 2015.

b. Now, I using Qt5 as toolkit, because authors of Qt announced "Qt4 is obsolete, will be updated no longer".

c. All of virtual machines are already ported to Qt (On Oct 29, 2015).

d. Now using GCC-6.1 with Link Time Optimize to build for distrubuted binaries.

e. Implemented socket, networking for MZ-2500, but, not tested yet (；´Д｀)

Upstream repositry:
https://github.com/Artanejp/common_source_project-fm7

Project Page:

https://osdn.jp/projects/csp-qt/

Upstream (Takeda Toshiya San's original code):

http://takeda-toshiya.my.coocan.jp/

Changes:
* SNAPSHOT Aug 11, 2017
  * Upstream 2017-08-10.
  * [EMU/ROMAKANA] Fix not convert with Qt.Use functions within EMU:: , not use original ROMAKANA functions.
  * [VM] Add PC-9801RA and PC-9801VX.
  * [VM] Add devices to libCSPcommon_vm mostly.
  * [VM] Fix FTBFS and bugs a lot.
  * [VM/FM7] Stop using DUMMYDEVICE:: . Use VM::get_extra_leds() to get led status.
  * [VM/MB8877] DISK:Fix not apply workaround to Gambler Jiko Chusin-ha for FM-7 series.
  * [VM/DATAREC] Fix crash with MZT data.
  * [Qt/UI] OpenGL: Display ICONs when accessing to virtual medias.
  * [Qt/UI]  Separate status bar display:Accessing to virtual medias.
  * [Qt/UI] Menu: Make macro to be easier constructing.
  * [Qt/UI] Ui_MainWindowBase:: Make private variables/functions not accessed from Ui_MainWindow:: .
  * [Qt/UI] Display LEDs with USE_EXTRA_LEDS or USE_KEY_LOCKED.See common/emu_thread.cpp for details.
  * [Qt/UI] Fix some memory leaks.
  * [Qt/OpenGL] Fix aspect ratio with some zoom type.
  * [Qt/FM7] Fix wrong scaling at VMs (only FM-8/7/77/AV) has only 200line (not have 400line). 
  * [BUILD/CMake] CCACHE: Fix SEGFAULT at linking after upgrade GNU toolchain.
  * Build with 04e08d2708a595c518ae0bd92c1713e1854c4310 (or later).

-- Aug 11, 2017 23:38:49 +0900 K.Ohta <whatisthis.sowhat@gmail.com>

Upstream changes:
-----
8/10/2017

[EMU] support to enter 0-9 by numpad key while roman to kana is enabled
[EMU] support to enter shift + function key while roman to kana is enabled
[EMU/DEBUGGER] fix to wait until cpu is suspended and enters into waiting loop

[VM/I386] fix to flush vtlb after modifying address mask
[VM/UPD7220] support to specify device class to access vram
[VM/Z80] fix to run dma before checking interrupts

[PC8801/PC88] fix monocolor graph screen to get color index from text attribute
[PC8801/PC88] fix monocolor graph screen to render with graph palette

[PC9801VX] support NEC PC-9801VX
[PC9801/CPUREG] support address mask i/o
[PC9801/DISPLAY] support EGC (thanks Neko Project 2)
[PC9801/DISPLAY] support EGC/GRCG access from graphic GDC
[PC9801/MEMBUS] support 24bit/32bit address memory bus
[PC9801/MEMBUS] support ITF rom


6/22/2017

[EMU] move auto key codes from winmain to emu class
[EMU] support to convert roman letters to kana letters
[WINMAIN] support APPLICATION accelerator to enable/disable roman to kana
[WINMAIN] support CTRL+ALT+ENTER accelerator to enable/disable full speed

[VM/I386] improve i86/i286 core based on MAME 0.185
[VM/UPD765A] fix device status (thanks annonymus guy)
[VM/YM2203] fix to mask YM2608 ports in YM2203 case (thanks annonymus guy)

[PC8801/PC88] fix bank switch of extend ram (thanks annonymus guy)
[PC8801/PC88] fix crtc for dma underrun case (thanks annonymus guy)


5/28/2017

[WINMAIN] support to run simulation at full speed

[VM/I386] improve i386 core based on MAME 0.185


5/20/2017

[YIS/DISPLAY] support correct font rom (thanks Mr.Moriya)
[YIS/DISPLAY] support native graphic commands
[YIS/DISPLAY] include KST32B stroke font and its decoder (thanks Mr.Saka.N)

[X1TURBOZ/DISPLAY] fix 8 color mode with 4096 palette (thanks Mr.Sato)


5/17/2017

[X1TURBOZ/DISPLAY] fix 64/4096 color mode (thanks Mr.Sato)

-----


Have fun!
-- Ohta.

