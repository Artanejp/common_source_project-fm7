** Qt porting and FM-7/77/AV/AV40/EX for Common Source Code Project **

                                                       December 04, 2017
                            K.Ohta  (whatisthis.sowhat _at_ gmail.com)

1.About

This package is Qt5 porting of Common Source Code Project (CSP)
and built with Qt5, for Windows, built with MinGW(32bit).

Source Code:

   https://github.com/Artanejp/common_source_project-fm7/releases/tag/SNAPSHOT_20171204
   
Additional INFO:

   Binaries will be available, distibute from osdn.net.
   
   See, https://osdn.net/projects/csp-qt/  and
        https://osdn.net/projects/csp-qt/releases/ .
	
   Released at:


2.Background

Common Source Code Project (CSP) is good emulator writing.
It also distributed with GPLv2, this is good for me.

But codes are specified to M$ Visual C.
I'm using GNU/Linux, and I starting to apply FM-7(or later).

So, I start to port to GNU/Linux and using Qt4/Qt5.

What you need at least:

a. Qt5 (neither Qt3 and Qt4) toolkit: Qt5.3 or later.

b. Some OpenGL implementation, maybe at leaset OpenGL v2.x .

c. gcc / g++ (5.0 or later? ) or llvm clang / clang++ (3.5 or later?) toolchain.

d. SDL2 (not SDL1.x).

e. CMake 2.8 or later.

* TIPS: If emufoo.exe don't show screen drawing, set environment variable QT_OPENGL to software (i.e. Using Windows as VirtualBox's gueat OS).


3.How to build:

After extracting (or git pulled) sourcecodes:

$ cd {srctop}/source/build-cmake/{Machine name}/

$ mkdir build

$ cd build

To configure:

$ cmake ..

or

$ ccmake ..

To build:

$ make

To install:

$ sudo make install

4.Qt specified notice:

*Place R@Ms under $HOME/emu{Machine Name}/ , this directory has made
after first using.

*Config file, {foo}.ini is writteon on $HOME/.config/emu{Machine Name}/ .

5.Status

a. I tested to build only under Debian GNU/Linux "sid",Ubuntu Linux 16.04LTS "Xenial" for AMD64 (x86_64)
and MinGW with GCC6 (Windows 32bit).

   But, perhaps, will succed to build another GNU/Linux OSs or BSD OS variants.
   
   * On windows, using MinGW is already okay, but not tested drawing.
   
   * Cross building with GNU/Linux's MinGW32 and Qt5.5.1 (for MinGW) is available. 
     Modify and use build-cmake/config_build_cross_win32.sh and related *.cmake files.
     
   * And, you can also build with M$ Visual Studio 2013 or 2015.

b. Now, I using Qt5 as toolkit, because authors of Qt announced "Qt4 is obsolete, will be updated no longer".

c. All of virtual machines are already ported to Qt (On Oct 29, 2015).

d. Now using GCC-6.1 with Link Time Optimize to build for distrubuted binaries.

e. Implemented socket, networking for MZ-2500, but, not tested yet (ï¼›Â´Ð”ï½€)

Repositry:

   https://github.com/Artanejp/common_source_project-fm7

   https://osdn.net/projects/csp-qt/scm/git/common_source_project-fm7


Project Page:

   https://osdn.jp/projects/csp-qt/

Upstream (Takeda Toshiya San's original code):

   http://takeda-toshiya.my.coocan.jp/

Changes:

* To see older changes, read ChangeLog and 000_gitlog.txt.

* SNAPSHOT Dec 04, 2017
  * Upstream 2017-12-03.
  * [VM/MC6809] Fixing hangup with F-BASIC v3.0Îµ.Thanks to Ryu Takegami-San. 
                (see https://matsuri.5ch.net/test/read.cgi/i4004/1483504365/641-645)
  * [VM/FM7] DISPLAY: Implement software scan line(s).
  * [VM/FM77AV] VRAM: More use SIMD to be faster.
    [VM/FM7] Try: Add suuporting for OPpenMP.But be slower than not using OpenMP (/_;)
  * Build with commit 9eb246b375699752a898d8be79a227f58e473d8e (or later).

-- Dec 04, 2017 19:29:05 +0900 K.Ohta <whatisthis.sowhat@gmail.com>

Upstream changes:
* To see older upstream's changes, read history.txt.

12/3/2017

[VM/UPD765A] fix read diagnostic to set ND when 1st sector's id are not match


11/28/2017

[EMU/DEBUGGER] fix ut command to show correct range of cpu trace

[VM/DEVICE] rename bios_call_i86() to bios_call_far_i86()
[VM/HUC6280] support to show total cpu clocks in debugger
[VM/HUC6280] support cpu trace
[VM/I286] support to show total cpu clocks in debugger
[VM/I286] support cpu trace
[VM/I386] support to show total cpu clocks in debugger
[VM/I386] support cpu trace
[VM/M6502] support to show total cpu clocks in debugger
[VM/M6502] support cpu trace
[VM/MC6800] support to show total cpu clocks in debugger
[VM/MC6800] support cpu trace
[VM/MC6800] fix issue that can not break at instruction following tap/cli/sei
[VM/MC6809] support to show total cpu clocks in debugger
[VM/MC6809] support cpu trace
[VM/MCS48] fix to add clocks for interrupt to total cpu clocks
[VM/TMS9995] support to show total cpu clocks in debugger
[VM/TMS9995] support cpu trace
[VM/UPD7801] support to show total cpu clocks in debugger
[VM/UPD7801] support cpu trace
[VM/UPD7810] support to show total cpu clocks in debugger
[VM/UPD7810] support cpu trace
[VM/Z80] fix to add clocks for interrupt to total cpu clocks


11/26/2017

[PC8801MA] fix text attribute when dma underrun occurs


11/25/2017

[EMU/DEBUGGER] support command history
[EMU/DEBUGGER] support ut command (unassemble cpu trace)
[EMU/DEBUGGER] fix < command to check if command file is correctly opened

[EMU/OSD] fix initialize_screen_buffer() for RGB565 (thanks PC8801MA‰ü)
[EMU/OSD] improve read_console_input() to get cursor key

[VM/MCS48] support to show total cpu clocks in debugger
[VM/MCS48] support cpu trace
[VM/UPD7220] improve vsync/hsync timing
[VM/UPD7220] improve status register to select vblank/hblank by sync command
[VM/YM2151] improve not to load mamefm.dll again (thanks PC8801MA‰ü)
[VM/YM2203] improve not to load mamefm.dll again (thanks PC8801MA‰ü)
[VM/Z80] support to show total cpu clocks in debugger
[VM/Z80] support cpu trace

[PC8801MA] support OPN+OPN, OPNA+OPNA, and OPNA+OPN (thanks PC8801MA‰ü)
[PC8801MA] fix back space key issue (thanks PC8801MA‰ü)
[PC8801MA] fix bank switch of extrom (thanks PC8801MA‰ü)
[PC8801MA] fix not to apply digital palette in monochrome and digital mode
[PC8801MA] fix to apply analog palette in monochrome and analog mode
[PC8801MA] fix to apply reverse in text attribute to monochrome graphic
[PC8801MA] fix cpu mode "Z80 8MHz (FE2/MC)"

[X1/KEYBOAD] support phantom keys (thanks Mr.Sato)
[X1/SUB] fix not to check iei status when sub cpu sends ack (thanks Mr.Sato)


-----


Have fun!
-- Ohta.

