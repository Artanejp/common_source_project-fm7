** Qt porting and FM-7/77/AV/AV40/EX for Common Source Code Project **

                                                         Mar 07, 2017
                            K.Ohta  (whatisthis.sowhat _at_ gmail.com)

1.About

This package is Qt5 porting of Common Source Code Project (CSP)
and built with Qt5, for Windows, built with MinGW(32bit).

Source Code:

   https://github.com/Artanejp/common_source_project-fm7/releases/tag/SNAPSHOT_20170307
   
Additional INFO:

   Binaries will be available, distibute from osdn.net.
   
   See, https://osdn.net/projects/csp-qt/  and
        https://osdn.net/projects/csp-qt/releases/ .
	
   Released at:


2.Background

Common Source Code Project (CSP) is good emulator writing.
It also distributed with GPLv2, this is good for me.

But codes are specified to M$ Visual C.
I'm using GNU/Linux, and I starting to apply FM-7(or later).

So, I start to port to GNU/Linux and using Qt4/Qt5.

What you need at least:

a. Qt5 (neither Qt3 and Qt4) toolkit: Qt5.3 or later.

b. Some OpenGL implementation, maybe at leaset OpenGL v2.x .

c. gcc / g++ (5.0 or later? ) or llvm clang / clang++ (3.5 or later?) toolchain.

d. SDL2 (not SDL1.x).

e. CMake 2.8 or later.

* TIPS: If emufoo.exe don't show screen drawing, set environment variable QT_OPENGL to software (i.e. Using Windows as VirtualBox's gueat OS).


3.How to build:

After extracting (or git pulled) sourcecodes:

$ cd {srctop}/source/build-cmake/{Machine name}/

$ mkdir build

$ cd build

To configure:

$ cmake ..

or

$ ccmake ..

To build:

$ make

To install:

$ sudo make install

4.Qt specified notice:

*Place R@Ms under $HOME/emu{Machine Name}/ , this directory has made
after first using.

*Config file, {foo}.ini is writteon on $HOME/.config/emu{Machine Name}/ .

5.Status

a. I tested to build only under Debian GNU/Linux "sid",Ubuntu Linux 16.04LTS "Xenial" for AMD64 (x86_64)
and MinGW with GCC6 (Windows 32bit).

   But, perhaps, will succed to build another GNU/Linux OSs or BSD OS variants.
   
   * On windows, using MinGW is already okay, but not tested drawing.
   
   * Cross building with GNU/Linux's MinGW32 and Qt5.5.1 (for MinGW) is available. 
     Modify and use build-cmake/config_build_cross_win32.sh and related *.cmake files.
     
   * And, you can also build with M$ Visual Studio 2013 or 2015.

b. Now, I using Qt5 as toolkit, because authors of Qt announced "Qt4 is obsolete, will be updated no longer".

c. All of virtual machines are already ported to Qt (On Oct 29, 2015).

d. Now using GCC-6.1 with Link Time Optimize to build for distrubuted binaries.

e. Implemented socket, networking for MZ-2500, but, not tested yet (；´Д｀)

Upstream repositry:
https://github.com/Artanejp/common_source_project-fm7

Project Page:

https://osdn.jp/projects/csp-qt/

Upstream (Takeda Toshiya San's original code):

http://takeda-toshiya.my.coocan.jp/

Changes:

* SNAPSHOT March 07, 2017
  * Upstream 2017-03-04
  * [VM] Some devices have prepared to move to libCSPcommon_vm .
  * [VM/FMGEN] Move FMGEN to libCSPfmgen .
  * [WIN32] Ready to build with DLLs contain GUI and AVIO and some features.
  * [BUILD] Selectable building.
  * [BUILD] Add logging build-status.
  * [Qt] Fix break device files when exiting emulator with some situations.
  * [Win32/OpenGL/WIP] TRY: Fixing crash with OpenGL3.0 at Corei5-2420M (and Windows7) PC. See Issues.txt or Issues.ja.txt.
  * [DOC] Update Issues.See http://hanabi.2ch.net/test/read.cgi/i4004/1483504365/30 .
  * [EMU/DEBUGGER] Use pthread_t instead of SDL_Thread.
  * [Qt/OSD] Remove do_call_debugger_command().
  * [SOUND/VM] Fix choppy sounds with some devices. i.e. PCM1BIT. Thanks to Takeda-San and Umaiboux-San.
  * [VM/FMGEN] Fix crash with GCC-5.This is issue of optimization, add "volatile" to any member(s).
  * [BUILD/LINUX] GCC5: (MAYBE) Enable to set "USE_RADICAL_OPTIMIZE" to "YES".
  * Built with 2dac70eb1743e2a0b778a57a1f520fce59aa6371 or newer.

-- Mar 07, 2017 15:55:25 +0900 K.Ohta <whatisthis.sowhat@gmail.com>

* SNAPSHOT January 30, 2017
  * Upstream 2016-12-31
  * [VM/SOUND] Fix problems voice with PCM (at least MSX and FM-7(Reviver)).
               See http://hanabi.2ch.net/test/read.cgi/i4004/1483504365/37 .
. * [VM/MB8877] Fix accessing 2D disk from 2DD mode drive (not 2D mode).
                Fixed booting issue of REVIVER for FM-7/77/AV with FM77AV40/EX/SX.
  * [Draw/Qt] Fix wrong aspect when using variable screen size.i.e.)emufm7/emufm77av40ex.
  * [UI/OpenGL] Add selection of draw infrastracture; OpenGLv3(MAIN) and OpenGLv2 (and OpenGLv3.2(Core): Still not implemented).
  * [Qt/OpenGL] Fix backgrounds not display at one-board-computer drawing with OpenGLv2.
  * [Qt/LOG] Enable syslog *truely*.
  * Built with cef2d4601438fd1fa680485ddba3434690e58451 or newer.

-- Jan 30, 2017 05:04:55 +0900 K.Ohta <whatisthis.sowhat@gmail.com>

* SNAPSHOT January 24, 2017
  * Upstream 2016-12-31
  * [UI/Qt] Add tooltips to menu entries mostly.
  * [UI/Qt] Add Japanese translations to menu entries mostly.
  * [SOUND] Add "Strict Rendering" entry to sound menu, for PCM1BIT device.
  * [VM/FM7] Fix crash without connecting FDDs.
  * [VM/UPD7752] Fix (´∀｀)＜ぬるぽ sometimes.
  * [DRAW/FM7] Fix wrong screen aspect on VMs without variable lines.
  * [Build/Linux] Fix scripts.
  * [Build/Linux] Fix crash built with gcc-5 (or earlier). Fixed for Ubuntu16.04LTS.
  * [Build/Linux] Separate builds both Debian/sid and Ubuntu/16.04LTS (expects to work with Debian/stable).
  * Built with 6e93d6920626193bf37fa6dfc2f41a8e84d8fd78 or newer.

-- Jan 24, 2017 01:06:26 +0900 K.Ohta <whatisthis.sowhat@gmail.com>

* SNAPSHOT January 06, 2017
  * Upstream 2016-12-31
  * Add Coleco Colecovision and SHARP SM-B-80TE (from upstreeam).
  * [FM7] Reduce graphic buffer for non-400 lines machines.
  * [WIN32/Qt] Cross-Build Qt libs: disable EGLFS (not EGL).
  * [Qt] One board computers: Read correctly background PNG even using indexed colors.
  * [Qt/GL] One board computers: Correctness drawing with GL3.0.
  * Built with 9bfdcc78ff194a934a2d57ce6d4f1cbec9f26a58 or newer.

-- Jan 06, 2017 19:56:37 +0900 K.Ohta <whatisthis.sowhat@gmail.com>

Upstream changes:
-----
3/4/2017

[WINMAIN] add interfaces for bubble casette (thanks Mr.Artane.)

[EMU] add interfaces for bubble casette (thanks Mr.Artane.)

[VM/*] import Mr.Artane.'s fixes (Commits on Feb 18, 2017)

[VM/AY_3_891X] split YM2203 and AY-3-891X (thanks Mr.Artane.)

[VM/DISK] fix trim buffer routine for 2D disk image (thanks Mr.Artane.)

[VM/EVENT] support light weight sound rendering (thanks Mr.Artane.)

[VM/MB8877] fix seek command for 2D disk image (thanks Mr.Artane.)

[FM77AV] import Mr.Artane.'s fixes (Commits on Feb 18, 2017)


3/1/2017

[EMU/DEBUGGER] support < command (input commands from file)

[X1/MEMORY] support to unmap rom by reading port 1Exxh (thanks Mr.Sato)


2/9/2017

[WINMAIN] support to draw bitmap image onto buttons

[WINMAIN] fix to redraw pcb bitmap image when window is invalidated

[WIN32/SCREEN] fix to invalidate rects for 7-seg leds and buttons

[BABBAGE2ND] add bitmap images for buttons

[EX80] add bitmap images for buttons

[SMB80TE] add bitmap images for buttons

[TK80BS] add bitmap images for buttons

[TK85] support NEC TK-85

[YS6464A] add bitmap images for buttons

12/31/2016

[COLECOVISION/KEYBOARD] fix not to raise irq when joystick is pressed

[COLECOVISION/KEYBOARD] fix joystick/tenkey inputs

[COLECOVISION/KEYBOARD] fix to save/load tenky enabled status

[SC3000/MEMORY] support 32KB+16KB or 128KB ROM carts


12/30/2016

[COLECOVISION] support COLECO ColecoVision (thanks Mr.tanam)
-----


Have fun!
-- Ohta.

